date: Pending

behavior_changes:
# *Changes that are expected to cause an incompatibility if applicable; deployment changes are likely required*

minor_behavior_changes:
# *Changes that may cause incompatibilities for some users, but should not for most*

bug_fixes:
# *Changes expected to improve the state of the world and are unlikely to have negative effects*

removed_config_or_runtime:
# *Normally occurs at the end of the* :ref:`deprecation period <deprecated>`

new_features:
- area: basic_auth
  change: |
    Added :ref:`forward_username_header <envoy_v3_api_field_extensions.filters.http.basic_auth.v3.BasicAuth.forward_username_header>`
    config to forward the username to the backend.
- area: ext_proc
  change: |
    Added
    :ref:`grpc_initial_metadata <envoy_v3_api_field_extensions.filters.http.ext_proc.v3.ExtProcOverrides.grpc_initial_metadata>`
    config API to allow extending inherited metadata from
    :ref:`ExternalProcessor.grpc_service <envoy_v3_api_field_extensions.filters.http.ext_proc.v3.ExternalProcessor.grpc_service>`
    and
    :ref:`ExtProcOverrides.grpc_service <envoy_v3_api_field_extensions.filters.http.ext_proc.v3.ExtProcOverrides.grpc_service>`
    with the new or updated values.
- area: aws_request_signing
  change: |
    Update ``aws_request_signing`` filter to support use as an upstream HTTP filter. This allows successful calculation of
    signatures after the forwarding stage has completed, particularly if the path element is modified.
- area: aws_lambda
  change: |
    Update ``aws_lambda`` filter to support use as an upstream HTTP filter. This allows successful calculation of
    signatures after the forwarding stage has completed, particularly if the path element is modified.
- area: grpc reverse bridge
  change: |
    Change HTTP status to 200 to respect the gRPC protocol. This may cause problems for incorrect gRPC clients expecting the filter
    to preserve HTTP 1.1 responses.  This behavioral change can be temporarily reverted by setting runtime guard
    ``envoy.reloadable_features.grpc_http1_reverse_bridge_change_http_status`` to false.
- area: quic
  change: |
    Added QUIC protocol option :ref:`send_disable_active_migration
    <envoy_v3_api_field_config.listener.v3.QuicProtocolOptions.send_disable_active_migration>` to make the server send clients a transport
    parameter to discourage client endpoints from active migration.
- area: quic
  change: |
    Added support for QUIC listeners to :ref:`choose certificates based on SNI <arch_overview_ssl_cert_select>` and load certificates
    from formats other than PEM, such as :ref:`pkcs12 <envoy_v3_api_field_extensions.transport_sockets.tls.v3.TlsCertificate.pkcs12>`.
    This behavior can be disabled with runtime flag ``envoy.restart_features.quic_handle_certs_with_shared_tls_code``.
- area: ext_proc
  change: |
    implemented
    :ref:`request_attributes <envoy_v3_api_field_extensions.filters.http.ext_proc.v3.ExternalProcessor.request_attributes>`
    and
    :ref:`response_attributes <envoy_v3_api_field_extensions.filters.http.ext_proc.v3.ExternalProcessor.response_attributes>`
    config APIs to enable sending and receiving attributes to/from the external processing server.
- area: access log
  change: |
    added support for :ref:`%UPSTREAM_CONNECTION_ID% <config_access_log_format_upstream_connection_id>` for the upstream connection
    identifier.
- area: compression
  change: |
    Added Qatzstd :ref:`compressor <envoy_v3_api_msg_extensions.compression.qatzstd.compressor.v3alpha.Qatzstd>`.
- area: aws_lambda
  change: |
    Added :ref:`host_rewrite <envoy_v3_api_field_extensions.filters.http.aws_lambda.v3.Config.host_rewrite>` config to be used
    during signature.
- area: http3
  change: |
    Added experimental support for sending and receiving HTTP/3 METADATA frames.
- area: ext_proc
  change: |
    added
    :ref:`metadata_options <envoy_v3_api_field_extensions.filters.http.ext_proc.v3.ExternalProcessor.metadata_options>`
    config API to enable sending and receiving metadata from/to the external processing server. Both typed and untyped dynamic
    metadata may be sent to the server. If
    :ref:`receiving_namespaces <envoy_v3_api_field_extensions.filters.http.ext_proc.v3.MetadataOptions.receiving_namespaces>`
    is defined, returned metadata may be written to the specified allowed namespaces.
- area: wasm
  change: |
    added ``verify_signature`` foreign function to verify cryptographic signatures.
- area: monitoring
  change: |
    Add ``Envoy::ExecutionContext``, which is notified by ``ScopeTrackerScopeState``'s constructor and destructor. This feature is
    disabled by default, it can be enabled by runtime feature flag ``envoy.restart_features.enable_execution_context``. For more details,
    please see https://github.com/envoyproxy/envoy/issues/32012.
- area: rbac
  change: |
    Added :ref:`uri_template<envoy_v3_api_field_config.rbac.v3.Permission.uri_template>` which uses existing
    :ref:`UriTemplateMatchConfig<envoy_v3_api_msg_extensions.path.match.uri_template.v3.UriTemplateMatchConfig>`
    to allow use of glob patterns for URI path matching in RBAC.
- area: upstream
  change: |
    Added :ref:`selection_method <envoy_v3_api_msg_extensions.load_balancing_policies.least_request.v3.LeastRequest>`
    option to the least request load balancer. If set to ``FULL_SCAN``,
    Envoy will select the host with the fewest active requests from the entire host set rather than
    :ref:`choice_count <envoy_v3_api_msg_extensions.load_balancing_policies.least_request.v3.LeastRequest>`
    random choices.
- area: access_loggers
  change: |
    Added :ref:`Fluentd access logger <envoy_v3_api_msg_extensions.access_loggers.fluentd.v3.FluentdAccessLogConfig>`
    to support flushing access logs in `Fluentd format <https://github.com/fluent/fluentd/wiki/Forward-Protocol-Specification-v1>`_.
- area: redis
  change: |
    Added support for the ``ECHO`` command.
- area: tcp_proxy
  change: |
    added an option to dynamically set a per downstream connection idle timeout period object under the key
    ``envoy.tcp_proxy.per_connection_idle_timeout_ms``. If this filter state value exists, it will override the idle timeout
    specified in the filter configuration and the default idle timeout.
- area: ext_authz
  change: |
    The proto field :ref:`headers <envoy_v3_api_field_service.auth.v3.AttributeContext.HttpRequest.headers>`'s
    value type is string.  Thus, it is unable to support non-utf8 characters in header values.
    To support header values with non-utf8 characters, a new boolean field was added to the
    ext_authz config :ref:`encode_raw_headers <envoy_v3_api_field_extensions.filters.http.ext_authz.v3.ExtAuthz.encode_raw_headers>`.
    When this is set to true, the new field in HttpRequest
    :ref:`header_map <envoy_v3_api_field_service.auth.v3.AttributeContext.HttpRequest.header_map>` (specifically
    ``header_map.headers.raw_value``) gets populated with the raw values instead of ``headers``,
    which normally contains UTF-8 sanitized header values. Also, since the new field is not a map,
    headers with the same key are not combined into a single comma-seperated header.
- area: load shed point
  change: |
    Added load shed point ``envoy.load_shed_points.hcm_ondata_creating_codec`` that closes connections before creating codec if
    Envoy is under pressure, typically memory.
- area: health_checks
  change: |
    added a :ref:`configuration option <envoy_v3_api_field_config.core.v3.HealthCheck.always_log_health_check_success>` that enables
    health check logs on each successful health check.
- area: string matcher
  change: |
    Added an :ref:`extension point for custom string matcher implementations <envoy_v3_api_field_type.matcher.v3.StringMatcher.custom>`.
    An implementation for :ref:`running a Lua script <envoy_v3_api_msg_extensions.string_matcher.lua.v3.Lua>` is included.
- area: overload
  change: |
    added a :ref:`configuration option
    <envoy_v3_api_field_extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.append_local_overload>` to add
    ``x-envoy-local-overloaded`` header when Overload Manager is triggered.
- area: access_loggers
  change: |
    Added :ref:`retry options
    <envoy_v3_api_msg_extensions.access_loggers.fluentd.v3.FluentdAccessLogConfig.RetryOptions>` to Fluentd Access Logger to
    support upstream reconnect options, backoff intervals.
- area: tracing
  change: |
    Added support to configure a Dynatrace sampler for the OpenTelemetry tracer.
- area: tracing
  change: |
    Added User-Agent header to OTLP trace exporters according to the OpenTelemetry specification.
- area: http
  change: |
    Added DownstreamRemoteReset to CoreResponseFlag, and it is set when stream is remote reset.
- area: tracing
  change: |
    Added support for variant span attribute type for the OpenTelemetry tracer.
- area: oauth
  change: |
    :ref:`deny_redirect_matcher <envoy_v3_api_field_extensions.filters.http.oauth2.v3.OAuth2Config.deny_redirect_matcher>`
    to support disabling authorization redirects for specific requests, e.g. AJAX requests.
- area: jwt_authn
  change: |
    Added
    :ref:`subjects <envoy_v3_api_field_extensions.filters.http.jwt_authn.v3.JwtProvider.subjects>` to allow restrictions
    of subjects a ``JwtProvider`` can assert.
- area: aws_request_signing
  change: |
    Update ``aws_request_signing`` filter to support optionally sending the aws signature in query parameters rather than headers,
    by specifying the :ref:`query_string <envoy_v3_api_field_extensions.filters.http.aws_request_signing.v3.AwsRequestSigning.query_string>`
    configuration section.
- area: formatters
  change: |
    Added :ref:`formatters <envoy_v3_api_field_extensions.access_loggers.fluentd.v3.FluentdAccessLogConfig.formatters>`
    to Fluentd access logger to allow adding extension commands when formatter access logs.
- area: proxy_protocol
  change: |
    Added :ref:`disallowed_versions <envoy_v3_api_field_extensions.filters.listener.proxy_protocol.v3.ProxyProtocol.disallowed_versions>`
    to enforce the filter only matches specific PROXY protocol versions.
- area: proxy_protocol
  change: |
    Added new statistics to the proxy protocol filter to track connections found/disallowed/errored by PROXY protocol version.
- area: rbac
  change: |
    Added :ref:`rules_stat_prefix <envoy_v3_api_field_extensions.filters.http.rbac.v3.RBAC.rules_stat_prefix>`
    to allow adding custom prefix to the stats emitted by rules.
- area: tracing
  change: |
    Dynatrace sampler fetches configuration from Dynatrace API.
- area: cors
  change: |
    Added :ref:`configuration option <envoy_v3_api_field_extensions.filters.http.cors.v3.CorsPolicy.forward_not_matching_preflights>`
    to return local response when CORS preflight's origin does not match allowed origin.
- area: ext_authz
  change: |
    Added support for populating the :ref:`tls_session<envoy_v3_api_field_service.auth.v3.AttributeContext.tls_session>`
    check request attribute for network ext_authz by setting :ref:`include_tls_session <config_network_filters_ext_authz>` to true.
- area: tracing
  change: |
    Datadog: span attributes and trace sampling can be configured remotely.
- area: aws
  change: |
    Update credential_provider utility to support EKS Pod Identity provided via token file.
- area: access_log
  change: |
    Added :ref:`%COMMON_DURATION% <config_access_log_format_common_duration>` to access log format to log the duration of the request.
    The start time point, end time point and duration precision can be configured in this new command.
- area: admin
  change: |
    The ``/stats/prometheus`` endpoint can now emit prometheus ``summary`` metric types by explicitly setting the
    ``histogram_buckets`` query parameter to ``summary``.

deprecated:
